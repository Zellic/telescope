(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{8281:function(e,s,t){Promise.resolve().then(t.bind(t,5704))},5704:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var l=t(7437),a=t(2265),r=t(5430),n=t(4531),i=t(9687),o=t(7484),c=t(4992),u=t(5735),d=t(6463),m=t(8385),h=t(8152),x=t(5971),f=t(228),p=t(8103),v=(0,x.Gp)((e,s)=>{var t;let{as:a,className:r,children:n,...i}=e,o=(0,f.gy)(s),{slots:c,classNames:u}=(0,h.R)(),d=(0,p.W)(null==u?void 0:u.header,r);return(0,l.jsx)(a||"div",{ref:o,className:null==(t=c.header)?void 0:t.call(c,{class:d}),...i,children:n})});v.displayName="NextUI.CardHeader";var j=t(5448),g=t(3376),C=t(5300),N=(0,t(2751).tv)({base:"shrink-0 bg-divider border-none",variants:{orientation:{horizontal:"w-full h-divider",vertical:"h-full w-divider"}},defaultVariants:{orientation:"horizontal"}}),b=(0,x.Gp)((e,s)=>{let{Component:t,getDividerProps:r}=function(e){var s;let t,l;let{as:r,className:n,orientation:i,...o}=e,c=r||"hr";"hr"===c&&"vertical"===i&&(c="div");let{separatorProps:u}=(s={elementType:"string"==typeof c?c:"hr",orientation:i},l=(0,C.z)(s,{enabled:"string"==typeof s.elementType}),("vertical"===s.orientation&&(t="vertical"),"hr"!==s.elementType)?{separatorProps:{...l,role:"separator","aria-orientation":t}}:{separatorProps:l}),d=(0,a.useMemo)(()=>N({orientation:i,className:n}),[i,n]);return{Component:c,getDividerProps:(0,a.useCallback)((e={})=>({className:d,role:"separator","data-orientation":i,...u,...o,...e}),[d,i,u,o])}}({...e});return(0,l.jsx)(t,{ref:s,...r()})});b.displayName="NextUI.Divider";var y=t(5378),P=t(3872),k=t(5748),S=t(4706),w=t(6186),E=t(7326);let A=(0,r.Pi)(e=>(0,l.jsx)("div",{className:"flex flex-col items-center mt-8",children:(0,l.jsxs)(m.w,{className:"max-w-[400px] min-w-[300px] p-2",children:[(0,l.jsxs)(v,{className:"block text-left",children:[(0,l.jsx)("p",{className:"font-bold text-large",children:e.header}),(0,l.jsx)("p",{className:"text-gray-400",children:e.subtitle})]}),(0,l.jsx)(b,{}),(0,l.jsx)(j.G,{className:"mt-2",children:e.children})]})})),z=(0,r.Pi)(()=>{let[e,s]=(0,a.useState)(""),[t,r]=(0,a.useState)(""),n=(0,o.gM)(),[c,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{u(!1)},[n.ssoClient]);let d=null;return e!=t&&(d="Password and confirm field must match."),(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsx)(E._Y,{value:e,onValueChange:e=>{s(e.replaceAll(E.c6,""))},valueConfirm:t,onValueChangeConfirm:e=>{r(e.replaceAll(E.c6,""))}}),d&&(0,l.jsx)("p",{className:"text-danger text-small",children:d}),c?(0,l.jsx)(k.c,{className:"ml-auto"}):(0,l.jsx)(i.A,{size:"md",disabled:null!=d||0===e.length,color:null==d&&e.length>0?"primary":"default",fullWidth:!1,isIconOnly:!0,className:"ml-auto",onClick:()=>{u(!0),n.ssoClient&&n.socket.setPassword(n.ssoClient.phone,e),s(""),r("")},children:(0,l.jsx)(P.Z1Y,{})})]})}),R=(0,r.Pi)(()=>{var e,s,t,r;let h=(0,o.gM)(),x=(0,d.useSearchParams)(),[f,p]=(0,a.useState)(""),[v,C]=(0,a.useState)(""),[N,b]=(0,a.useState)(!1),[E,R]=(0,a.useState)(""),T=h.ssoClient?function(e,s){let t=s.status.stage;return"PasswordRequired"===t||"AuthCodeRequired"===t||"EmailCodeRequired"===t?u.Tm[e.ssoClient.status.stage]:null}(h,h.ssoClient):null,_=null;if(null!==T&&(null==T?void 0:T.validate)!==null&&(_=T.validate(E)),(0,a.useEffect)(()=>{let e=g.s.getInstance().wsURL+"/socket";return h.socket.connect(e),()=>{h.socket.disconnect()}},[]),(0,a.useEffect)(()=>{h.ssoEmail&&C(h.ssoEmail)},[h.ssoEmail]),(0,a.useEffect)(()=>{b(!1),R("")},[null===(e=h.ssoClient)||void 0===e?void 0:e.status.stage]),(null===(s=h.ssoClient)||void 0===s?void 0:s.status.stage)==="AuthorizationSuccess"){let e=x.get("redirect");e&&(0,d.redirect)(e)}return"error"===h.socket.socketState||"closed"===h.socket.socketState?(0,l.jsx)(m.w,{children:(0,l.jsx)(j.G,{children:"Failed to reach server. Please try again later."})}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,l.jsx)(n.t,{}),(0,l.jsx)(c.E,{}),(0,l.jsx)(u.v,{}),(0,l.jsxs)("div",{className:"text-center mb-4",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Telescope Onboarding"}),!h.ssoClient&&(0,l.jsxs)(A,{header:"Telegram Information",subtitle:"Provide your Telegram phone number",children:[(0,l.jsx)(y.Y,{className:"mb-4",isRequired:!0,type:"text",label:"Phone number",placeholder:"Enter phone number...",labelPlacement:"outside",maxLength:11,pattern:"d{11}",value:f,onValueChange:e=>{p(e)}}),(0,l.jsx)(y.Y,{className:"mb-4",isRequired:!1,type:"email",isReadOnly:!0,label:"E-mail",placeholder:"Enter email...",labelPlacement:"outside",maxLength:255,value:v,onValueChange:e=>{C(e)}}),N?(0,l.jsx)(k.c,{className:"ml-auto"}):(0,l.jsx)(i.A,{size:"md",disabled:11!==f.length,color:11===f.length?"primary":"default",fullWidth:!1,isIconOnly:!0,className:"ml-auto",onClick:()=>{b(!0),h.socket.addAccount(f,v,null)},children:(0,l.jsx)(P.Z1Y,{})})]})]}),h.ssoClient&&"AuthorizationSuccess"!==h.ssoClient.status.stage&&(0,l.jsxs)(A,{header:"2FA & Password",subtitle:"Authenticate your Telegram account",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-bold text-medium",children:null!==(r=null!==(t=h.ssoClient.username)&&void 0!==t?t:h.ssoClient.name)&&void 0!==r?r:"<no username>"}),(0,l.jsx)("p",{className:"text-small text-gray-400",children:(0,w.u)(h.ssoClient.phone)}),(0,l.jsx)("p",{className:"text-small text-gray-400",children:h.ssoClient.email})]}),(0,l.jsx)(S.z,{className:"capitalize mt-5 ml-4",color:(0,w.U)(h.ssoClient),size:"md",variant:"flat",children:h.ssoClient.status.stage})]}),null!=T&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)(u.E$,{type:u.Tm[h.ssoClient.status.stage],errorMsg:_,value:E,onValueChange:e=>{(null==T?void 0:T.filter_regex)?R(e.replaceAll(T.filter_regex,"")):R(e)}})}),N?(0,l.jsx)(k.c,{className:"mt-4 ml-auto"}):(0,l.jsx)(i.A,{size:"md",disabled:null!=_||0===E.length,color:null==_&&E.length>0?"primary":"default",fullWidth:!1,isIconOnly:!0,className:"ml-auto mt-4",onClick:()=>{b(!0),h.setMockStage("AuthorizationSuccess")},children:(0,l.jsx)(P.Z1Y,{})})]}),h.ssoClient&&"AuthorizationSuccess"===h.ssoClient.status.stage&&(0,l.jsx)(A,{header:"Save your 2FA password",subtitle:"This password is stored encrypted, not hashed",children:(0,l.jsx)(z,{})})]})});var T=(0,r.Pi)(()=>(0,l.jsx)(a.Suspense,{children:(0,l.jsx)(R,{})}))},6463:function(e,s,t){"use strict";var l=t(1169);t.o(l,"redirect")&&t.d(s,{redirect:function(){return l.redirect}}),t.o(l,"useRouter")&&t.d(s,{useRouter:function(){return l.useRouter}}),t.o(l,"useSearchParams")&&t.d(s,{useSearchParams:function(){return l.useSearchParams}})}},function(e){e.O(0,[492,147,51,240,217,821,331,364,118,971,23,744],function(){return e(e.s=8281)}),_N_E=e.O()}]);