(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1782:function(e,t,s){Promise.resolve().then(s.bind(s,2449)),Promise.resolve().then(s.bind(s,4384)),Promise.resolve().then(s.bind(s,2014)),Promise.resolve().then(s.bind(s,5137)),Promise.resolve().then(s.t.bind(s,231,23)),Promise.resolve().then(s.t.bind(s,4332,23)),Promise.resolve().then(s.t.bind(s,2882,23)),Promise.resolve().then(s.t.bind(s,6571,23))},2449:function(e,t,s){"use strict";s.d(t,{Providers:function(){return d}});var n=s(7437);s(2265);var o=s(2485),a=s(6463),r=s(5169),c=s(7484);let i=e=>{let{children:t}=e;return(0,n.jsx)(c.wm,{value:c.no,children:t})};function d(e){let{children:t,themeProps:s}=e,c=(0,a.useRouter)();return(0,n.jsx)(o.w,{navigate:c.push,children:(0,n.jsx)(r.f,{...s,children:(0,n.jsx)(i,{children:t})})})}},7484:function(e,t,s){"use strict";s.d(t,{c:function(){return _},wm:function(){return A},no:function(){return O},gM:function(){return R}});var n,o,a,r,c=s(8890),i=s(2265);let d=c.V5.enumeration("ActionType",["default","disconnect","add_test_account"]),l=c.V5.model({key:c.V5.string,label:c.V5.string,color:c.V5.maybeNull(c.V5.enumeration("Color",["default","primary","secondary","success","warning","danger"])),actionType:d}),u=c.V5.maybeNull(c.V5.reference(c.V5.late(()=>s(7484).c),{get(e,t){var s;return(null===(s=(0,c.yj)(t).clients)||void 0===s?void 0:s.find(t=>t.phone===e))||null},set:e=>e.phone})),S=c.V5.model({title:c.V5.string,message:c.V5.string,buttons:c.V5.array(l),client:u}),E=c.V5.model({addAccount:c.V5.maybeNull(c.V5.enumeration("AddAccountMode",["normal","onboarding"])),addAccountPhone:c.V5.maybeNull(c.V5.string),provide:u,editPassword:u,deleteClient:u,message:c.V5.maybeNull(S)}).actions(e=>({setProvideClient:function(t){e.provide=t},setEditPasswordClient:function(t){e.editPassword=t},setDeleteClient:function(t){e.deleteClient=t},setAddAccount:function(t){e.addAccount=t},setAddAccountPhone:function(t){e.addAccountPhone=t},setMessage:function(t,s,n,o){e.message=S.create({title:t,message:s,buttons:n,client:o||null})},setMessageBasic:function(t,s,n){e.message=S.create({title:t,message:s,buttons:[{key:"okay",label:"Okay",color:"primary",actionType:"default"}],client:n||null})},clearMessage:function(){e.message=null}}));(n=a||(a={})).ADD_ACCOUNT="ADD_ACCOUNT",n.ADD_TEST_ACCOUNT="ADD_TEST_ACCOUNT",n.SUBMIT_VALUE="SUBMIT_VALUE",n.DELETE_ACCOUNT="DELETE_ACCOUNT",n.CONNECT_CLIENT="CONNECT_CLIENT",n.DISCONNECT_CLIENT="DISCONNECT_CLIENT",n.SET_PASSWORD="SET_PASSWORD";let C=c.V5.model({socketState:c.V5.enumeration(["connecting","open","closed","error"]),responseStatus:c.V5.enumeration(["waiting","received"])}).volatile(e=>({socket:null})).actions(e=>({setState(t){e.socketState=t},connect(t){e.socket&&e.socket.close(),this.setState("connecting"),e.socket=new WebSocket(t),e.socket.onopen=()=>{this.setState("open")},e.socket.onclose=()=>{this.setState("closed")},e.socket.onerror=e=>{this.setState("error")},e.socket.onmessage=t=>{let s=JSON.parse(t.data);console.log(s),s.hasOwnProperty("type")?(0,c.yj)(e).updateFromSocket(s):console.error("WebSocket data must contain an `id` field")}},sendMessage(t){e.socket&&e.socket.readyState===WebSocket.OPEN?e.socket.send(JSON.stringify(t)):console.error("Failed to send message: WebSocket is closed")},addAccount(e,t,s){this.sendMessage({type:a.ADD_ACCOUNT,data:{phone:e,email:t,comment:s}})},addTestAccount(){this.sendMessage({type:a.ADD_TEST_ACCOUNT})},submitValue(e,t,s){this.sendMessage({type:a.SUBMIT_VALUE,data:{phone:e,stage:t,value:s}})},deleteAccount(e){this.sendMessage({type:a.DELETE_ACCOUNT,data:{phone:e}})},disconnectClient(e){this.sendMessage({type:a.DISCONNECT_CLIENT,data:{phone:e}})},connectClient(e){this.sendMessage({type:a.CONNECT_CLIENT,data:{phone:e}})},setPassword(e,t){this.sendMessage({type:a.SET_PASSWORD,data:{phone:e,password:t}})},setWaiting(){e.responseStatus="waiting"},setReceived(){e.responseStatus="received"},disconnect(){e.socket&&(e.socket.close(),e.socket=null,e.socketState="closed")}}));(o=r||(r={})).SSO_START="SSO_START",o.CLIENT_START="CLIENT_START",o.ADD_ACCOUNT_RESPONSE="ADD_ACCOUNT_RESPONSE",o.ADD_TEST_ACCOUNT_RESPONSE="ADD_TEST_ACCOUNT_RESPONSE",o.SUBMIT_VALUE_RESPONSE="SUBMIT_VALUE_RESPONSE",o.DELETE_ACCOUNT_RESPONSE="DELETE_ACCOUNT_RESPONSE",o.CONNECT_CLIENT_RESPONSE="CONNECT_CLIENT_RESPONSE",o.DISCONNECT_CLIENT_RESPONSE="DISCONNECT_CLIENT_RESPONSE",o.SET_PASSWORD_RESPONSE="SET_PASSWORD_RESPONSE";let N=c.V5.model({stage:c.V5.enumeration("AuthState",["ClientNotStarted","WaitingOnServer","PasswordRequired","AuthCodeRequired","EmailRequired","EmailCodeRequired","AuthorizationSuccess","ConnectionClosed","ErrorOccurred","PhoneNumberRequired","RegistrationRequired"]),inputRequired:c.V5.boolean,error:c.V5.maybeNull(c.V5.string)}),T=c.V5.enumeration("Privileges",["view","edit_two_factor_password","login","manage_connection_state","remove_account"]),_=c.V5.model({name:c.V5.maybeNull(c.V5.string),username:c.V5.maybeNull(c.V5.string),email:c.V5.maybeNull(c.V5.string),comment:c.V5.maybeNull(c.V5.string),phone:c.V5.string,lastCode:c.V5.maybeNull(c.V5.model({value:c.V5.number,date:c.V5.number})),status:N,privileges:c.V5.array(T)}).actions(e=>({updateStatus(t){e.status=N.create(t)}})),m=c.V5.enumeration("Environment",["Staging","Production"]),O=c.V5.model({clients:c.V5.array(_),ssoClient:u,ssoEmail:c.V5.maybeNull(c.V5.string),clientsState:c.V5.enumeration("State",["pending","done"]),environment:m,modals:E,socket:C}).actions(e=>({updateFromSocket:function(t){switch(console.log(t.type),t.type){case r.CLIENT_START:e.clients=t.data.items||[],e.environment=t.data.environment,e.clientsState="done";break;case r.SSO_START:e.ssoEmail=t.data.email,e.ssoClient=e.clients.find(t=>t.email===e.ssoEmail);break;case r.ADD_ACCOUNT_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status&&e.modals.setMessageBasic("Error","Failed to add account: ".concat(t.data.error));break;case r.ADD_TEST_ACCOUNT_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status?e.modals.setMessageBasic("Error","Couldn't create test account: ".concat(t.data.error)):e.modals.setMessageBasic("Success","Created test account.");break;case r.SUBMIT_VALUE_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status&&console.error("SUBMIT_VALUE_RESPONSE: ".concat(t.data.error));break;case r.DELETE_ACCOUNT_RESPONSE:e.modals.setDeleteClient(null),e.socket.responseStatus="received","ERROR"===t.data.status&&e.modals.setMessageBasic("Error","Failed to delete account: ".concat(t.data.error));break;case r.CONNECT_CLIENT_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status?e.modals.setMessageBasic("Error","Couldn't connect account: ".concat(t.data.error)):e.modals.setMessageBasic("Success","Connected account.");break;case r.DISCONNECT_CLIENT_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status?e.modals.setMessageBasic("Error","Couldn't disconnect account: ".concat(t.data.error)):e.modals.setMessageBasic("Success","Disconnected account.");break;case r.SET_PASSWORD_RESPONSE:e.socket.responseStatus="received","ERROR"===t.data.status&&e.modals.setMessageBasic("Error","Failed to edit account password for: ".concat(t.data.error))}}})).create({clients:[],clientsState:"pending",environment:"Production",modals:{},socket:{socketState:"connecting",responseStatus:"received"}}),g=(0,i.createContext)(null),A=g.Provider;function R(){let e=(0,i.useContext)(g);if(null===e)throw Error("Store cannot be null, please add a context provider");return e}(0,c.cf)(O,e=>{console.log("snapshot",e)})},4332:function(){}},function(e){e.O(0,[228,895,492,147,49,966,971,23,744],function(){return e(e.s=1782)}),_N_E=e.O()}]);